<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="Guide3D: A Bi-planar X-ray Dataset for 3D Shape Reconstruction.">
  <meta name="keywords" content="X-ray, 3D Shape Reconstruction">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FedEFM: Federated Endovascular Foundation Model with Unseen Data</title>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="icon" href="./static/images/aioz.svg">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
</head>
<body>

<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">FedEFM: Federated Endovascular Foundation Model with Unseen Data</h1>
          <div class="is-size-5 publication-authors">
			<span class="author-block">
              <a href="https://scholar.google.com/citations?user=qCcSKkMAAAAJ&hl=en">Tuong Do</a><sup>1,2,*</sup>,
            </span>
			<span class="author-block">
              <a href="https://www.linkedin.com/in/nghiavuhuu/">Nghia Vu</a><sup>2,*</sup>,
            </span>
            <span class="author-block">
              <a href="https://scholar.google.com/citations?user=DYV6ztgAAAAJ&hl=en">Tudor Jianu</a><sup>2</sup>,
            </span>
			            <span class="author-block">
              <a href="https://scholar.google.com/citations?user=unbPvWAAAAAJ&hl=zh-CN">Baoru Huang</a><sup>1</sup>,
            </span>
			            <span class="author-block">
              <a href="https://scholar.google.com/citations?user=qyExc4QAAAAJ&hl=en">Minh Vu</a><sup>3</sup>,
            </span>
            <span class="author-block">
              <a href="https://scholar.xjtlu.edu.cn/en/persons/JionglongSu">Jionglong Su</a><sup>4</sup>,
            </span>
			<span class="author-block">
              <a href="https://sg.linkedin.com/in/erman-tjiputra">Erman Tjiputra</a><sup>2</sup>,
            </span>
			<span class="author-block">
              <a href="https://scholar.google.com/citations?user=DbAThEgAAAAJ&hl=en">Quang D. Tran</a><sup>1,2</sup>,
            </span>
			<span class="author-block">
              <a href="https://scholar.google.com.tw/citations?user=rkhWIKoAAAAJ&hl=zh-TW">Te-Chuan Chiu</a><sup>5</sup>,
            </span>
            <span class="author-block">
              <a href="https://cgi.csc.liv.ac.uk/~anguyen/">Anh Nguyen</a><sup>1</sup>,
            </span>
          </div>
      <!--/ Intro Image. -->
          <div class="is-size-5 publication-authors">
            <span class="author-block"><sup>1</sup><b>University of Liverpool, UK</b></span><br />
			<span class="author-block"><sup>2</sup><b>AIOZ, Singapore</b></span><br />
			<span class="author-block"><sup>3</sup><b>Automation & Control Institute, TU Wien, Austria</b></span><br />
			<span class="author-block"><sup>4</sup><b>Xi'an Jiaotong-Liverpool University, China</b></span><br />
            <span class="author-block"><sup>5</sup><b>National Tsing Hua University, Taiwan</b></span><br />
			<span class="author-block"><sup>*</sup><b>These authors contributed equally to this work.</b></span><br />
          </div>

          <div class=" is-centered has-text-centered">
            <div class="publication-links">
              <!-- PDF Link. -->
              <span class="link-block">
                <a href=""
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span>
              <span class="link-block">
                <a href=""
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>
              <!-- Video Link. 
              <span class="link-block">
                <a href="#"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-youtube"></i>
                  </span>
                  <span>Video</span>
                </a>
              </span>-->
              <!-- Code Link. -->
              <span class="link-block">
                <a href=""
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Dataset (Coming soon)</span>
                  </a>
              </span> 
              <!-- Video. -->
              <!--<span class="link-block">
                <a href=""
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="far fa-images"></i>
                  </span>
                  <span>Video</span>
                  </a>-->
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="section">
<div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
		<div class="column is-four-fifths">
			<h2 class="title is-3">Abstract</h2>
				<div class="content has-text-justified">
					In endovascular surgery, the precise identification of catheters and guidewires in X-ray images is essential for reducing intervention risks. However, accurately segmenting catheter and guidewire structures is challenging due to the limited availability of labeled data. Foundation models offer a promising solution by enabling the collection of similar-domain data to train models whose weights can be fine-tuned for downstream tasks. Nonetheless, large-scale data collection for training is constrained by the necessity of maintaining patient privacy. This paper proposes a new method to train a foundation model in a decentralized federated learning setting for endovascular intervention. To ensure the feasibility of the training, we tackle the unseen data issue using differentiable Earth Mover's Distance within a knowledge distillation framework. Once trained, our foundation model's weights provide valuable initialization for downstream tasks, thereby enhancing task-specific performance. Intensive experiments show that our approach achieves new state-of-the-art results, contributing to advancements in endovascular intervention and robotic-assisted endovascular surgery, while addressing the critical issue of data sharing in the medical domain.   
				</div>
		</div>
    </div>
    

	
	<section class="section">
		<div class="container ">
        <!-- Dataset. -->
        <div class="columns is-centered has-text-centered">
        <div class="column is-four-fifths">
            <h2 class="title">Robotic Setup.</h2>
            <div class="content has-text-justified">
              To collect large-scale X-ray images, we employ a robotic platform and a full-size silicon phantom. A surgeon uses a master device joystick to control a follower robot for cannulating three arteries: the left subclavian (LSA), left common carotid (LCCA), and right common carotid (RCCA). The provided video shows an overview of our robotics setup and the data collecting progress. During each catheterization procedure, the surgeon activates the X-ray fluoroscopy using a pedal in the operating room. The experiments are conducted using the Epsilon X-ray Generator. We develop a real-time image grabber to transmit the video feed of the surgical scene to a workstation, a computer-based device equipped with an 8-Core ARM v8.2 64-bit CPU. Overall, we collect and label 4,700 new X-ray images to create our EIPhantom dataset.
			</div>
				<section class="section">
				  <!-- Paper video. -->
					<div class="columns is-centered has-text-centered">
						<div class="column is-four-fifths">
							<div class="publication-video">
								<video src="static/figures/Demo.mp4" type="video/mp4" controls></video>
							</div>
						</div>
					</div>   
				</section> 
			<h2 class="title">Simulation Data.</h2>
            <div class="content has-text-justified">
              Apart from X-ray images collected from our real robot, we also collect an EISimulation dataset from the CathSim simulator for simulated X-ray images. We manually label both data from the robot and CathSim simulator to use them in downstream tasks. We note that the datasets used to train the foundation model are not being used in downstream endovascular understanding tasks. 
			</div>
			
			<div class="publication-video">
				<img src="static/figures/dataView.png" alt="cars peace"/>
			</div>
			<div class="content has-text-justified">
               Table below summarises datasets related to endovascular intervention we use in this paper. All datasets cover different endovascular procedures with X-ray images as the main modality. The data are collected from diverse sources, including human/animal studies, human phantoms, and simulated environments.
			</div>
			<table border="1" cellspacing="0" cellpadding="5">
    <caption><strong>X-ray datasets used in our experiments.</strong></caption>
    <thead>
        <tr style="background-color: #EFEFEF;">
            <th>Phase</th>
            <th>Dataset</th>
            <th>#Frames</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td rowspan="5">Federated Foundation Training</td>
            <td>CathAction <cite>[Huang et al., 2024]</cite></td>
            <td>500,000</td>
        </tr>
        <tr style="background-color: #EFEFEF;">
            <td>VESSEL12 <cite>[Rudyanto et al., 2014]</cite></td>
            <td>12,892</td>
        </tr>
        <tr>
            <td>Drive <cite>[Staal et al., 2004]</cite></td>
            <td>8,028</td>
        </tr>
        <tr style="background-color: #EFEFEF;">
            <td>SenNet <cite>[Walsh et al., 2021]</cite></td>
            <td>7,436</td>
        </tr>
        <tr>
            <td>Medical Decathlon <cite>[Antonelli et al., 2022]</cite></td>
            <td>442</td>
        </tr>
        <tr>
            <td rowspan="4">Downstream Fine-tuning</td>
            <td>EISimulation (ours)</td>
            <td>1,683</td>
        </tr>
        <tr style="background-color: #EFEFEF;">
            <td>EIPhantom (ours)</td>
            <td>4,710</td>
        </tr>
        <tr>
            <td>RANZCR <cite>[Hansen et al., 2021]</cite></td>
            <td>33,664</td>
        </tr>
        <tr style="background-color: #EFEFEF;">
            <td>CathAnimal <cite>[Kongtongvattana et al., 2023]</cite></td>
            <td>25,000</td>
        </tr>
    </tbody>
</table>

			
			</div>
          
        </div>
      </div>
	</section>
	
	<section class="section">
		<div class="container ">
        <!-- Dataset. -->
			<div class="columns is-centered has-text-centered">
				<div class="column is-four-fifths">
					<h2 class="title">Unseen Data Issue</h2>
					<div class="content has-text-justified">
						We aim to train a federated foundation model for endovascular intervention with all possible types of X-ray data. In practice, each silo (hospital) retains certain data sources that may not be available at other hospitals. The issue arises from the dissimilarity in data corpora across hospitals, i.e., some data are available in one hospital but not in others. Figure below shows an illustration of this problem. Consequently, this leads to the unseen data issue that needs to be addressed to ensure the feasibility of the federated training process.
					</div>
					<div class="publication-video">
					<embed src="static/figures/Issue1.pdf" width="500" height="375" >
					</div>
				</div> 
			</div>
			
			<div class="columns is-centered">
				<div class="column is-four-fifths">
					<h2 class="title">Algorithm: Federated Knowledge Distillation with Earth Mover’s Distance</h2>
					We propose Algorithm below for training a foundation model within a decentralized federated learning process, effectively addressing the issue of the unseen data problem. 
				<head>
    
    <style>
        body {
            font-family: Arial, sans-serif;
        }
        pre {
            background-color: #f4f4f4;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            white-space: pre-wrap;
        }
        .keyword {
            font-weight: bold;
            color: #d73a49;
        }
        .comment {
            color: #6a737d;
            font-style: italic;
        }
    </style>
</head>
<body>

<pre>
<span class="keyword">Input:</span> Initial weight θᵢ(0) for each silo i; Maximum training round K.

<span class="keyword">for</span> k = 0 to K - 1 <span class="keyword">do</span>
    <span class="comment">// The loop below runs in parallel</span>
    <span class="keyword">for each</span> silo i <span class="keyword">do</span>
        𝒩(i) ← List of i-th neighbour nodes.
        
        ξᵢ(k) ← Sampling data from local silo i

        <span class="keyword">for each</span> silo j ∈ 𝒩(i) <span class="keyword">do</span>
            ξⱼ(k) ← Sampling data from the j-th neighbor of silo i
            
            θᵢ → ⱼ ← Train overseas expert model at j-th silo using Equation (intersilo)
            
            <span class="comment">// Collect overseas expert weights from j-th neighbor back to i-th silo</span>
            ̂θᵢ → ⱼ ← θᵢ → ⱼ  
            
            EMD(θᵢ, ̂θᵢ → ⱼ) ← Compute Earth Mover's Distance using Equation (EMD)
        <span class="keyword">end for</span>
        
        θᵢ(k+1) ← Compute 𝓛ⁱ_MD with Equation (distil_loss) and train i-th local model using Equation (cross_learn)
    <span class="keyword">end for</span>
<span class="keyword">end for</span>
</pre>

</body>
				</div> 
			</div>
			
		</div>
	</section>
	
 
    <section class="section" id="BibTeX">
		<div class="container is-max-desktop content">
			<h2 class="title">BibTeX</h2>
			<pre><code>Soon
			</code></pre>
		</div>
    </section>
</div>
</section>

<footer class="footer">
  <div class="container">
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            The website template was borrowed from <a
            href="https://github.com/nerfies/nerfies.github.io">Nerfies</a>. We would like to thank Keunhong Park for sharing the template.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

</body>
</html>